{% extends "base.html" %}

{% block content %}

<h1>Package {{ filename }}</h1>

{% if built %}

  {% if error %}

    <p>Error extracting package!</p>

    <p>Build log:</p>
    <pre>{% for line in log %}{{ line }}
{% endfor %}</pre>

  {% else %}

<div class="panel panel-default" id="panel1">
  <div class="panel-heading">
    <h4 class="panel-title">
      <a data-toggle="collapse" data-target="#buildlog"
         href="#buildlog" class="collapsed">
        Build log
      </a>
    </h4>
  </div>
  <div id="buildlog" class="panel-collapse collapse">
    <div class="panel-body">
      <pre>{% for line in log %}{{ line }}
{% endfor %}</pre>
    </div>
  </div>
</div>

<h2>Run the experiment</h2>

<form method="POST" action="{{ url_for('run', experiment_code=experiment_code) }}" enctype="multipart/form-data">
  <h3>Parameters</h3>

{% if params %}

  {% for param in params %}
  <div class="form-group">
    <label for="param_{{ param.name }}">{{ param.name }}</label>
    <input type="text" class="form-control" id="param_{{ param.name }}" name="param_{{ param.name }}" value="{{ param.default }}" placeholder="value">
  </div>
  {% endfor %}

{% else %}
  <p>No parameters</p>
{% endif %}

{% if input_files %}
  <h3>Input files</h3>

  {% for file in input_files %}
  <div class="form-group">
    <label for="inputfile_{{ file.name }}">{{ file.name }}</label>
    <input type="file" class="form-control" id="inputfile_{{ file.name }}" name="inputfile_{{ file.name }}">
  </div>
  {% endfor %}
{% endif %}

  <button type="submit" class="btn btn-default">Run</button>
</form>

  {% endif %}

{% else %}

<p>Waiting for package extraction, please wait...</p>

  {% if log %}

<pre>{% for line in log %}{{ line }}
{% endfor %}</pre>

  {% else %}

<p>Waiting for an available builder...</p>

  {% endif %}

{% endif %}

{% endblock content %}
